schema: '2.0'
stages:
  ingest:
    cmd: "python -m pipelines.ingestion.arxiv_metadata_ingest && python -m pipelines.ingestion.arxiv_pdf_acquire\n"
    deps:
    - path: pipelines/ingestion/arxiv_metadata_ingest.py
      hash: md5
      md5: 7c35b4dfe698d15244e2e2942cfef3cf
      size: 3996
    - path: pipelines/ingestion/arxiv_pdf_acquire.py
      hash: md5
      md5: 694a443188e8e59b25d6a92b5a14a514
      size: 4256
    params:
      params.yaml:
        ingestion:
          arxiv:
            enabled: true
            categories:
            - cs.AI
            - cs.LG
            - cs.CL
            max_papers: 3000
    outs:
    - path: data/raw
      hash: md5
      md5: 1b6667860006a563d2d2c893f902e108.dir
      size: 168350231
      nfiles: 100
  process:
    cmd: python -m pipelines.processing.extracting_and_chunking_pdfs --input_dir
      data/raw/pdfs --output_dir data/chunks
    deps:
    - path: data/raw
      hash: md5
      md5: 1b6667860006a563d2d2c893f902e108.dir
      size: 168350231
      nfiles: 100
    - path: pipelines/processing/extracting_and_chunking_pdfs.py
      hash: md5
      md5: d446672a7c1837b02489f0da0103da55
      size: 5314
    params:
      params.yaml:
        processing:
          chunk_size: 1000
          chunk_overlap: 200
          min_length: 50
    outs:
    - path: data/chunks
      hash: md5
      md5: 0e088d3d0cb50aae8f004a474d69c8dc.dir
      size: 4505595
      nfiles: 50
  embed:
    cmd: python -m pipelines.processing.build_embeddings_and_faiss --input_dir 
      data/chunks --output_dir data/indexes
    deps:
    - path: data/chunks
      hash: md5
      md5: 0e088d3d0cb50aae8f004a474d69c8dc.dir
      size: 4505595
      nfiles: 50
    - path: pipelines/processing/build_embeddings_and_faiss.py
      hash: md5
      md5: 72f6b2a19d0ae3e7842508f9f911dff0
      size: 2840
    params:
      params.yaml:
        indexing:
          embedding_model: sentence-transformers/all-MiniLM-L6-v2
          dimension: 384
          index_type: IDMap,Flat
    outs:
    - path: data/indexes
      hash: md5
      md5: 9a5d6a51c883d12a9279463a22844f42.dir
      size: 12082173
      nfiles: 3
  evaluate:
    cmd: python -m evaluation.evaluate
    deps:
    - path: data/indexes
      hash: md5
      md5: 9a5d6a51c883d12a9279463a22844f42.dir
      size: 12082173
      nfiles: 3
    - path: evaluation/evaluate.py
      hash: md5
      md5: fa730ee57ccfb0619ea07b6750253591
      size: 2866
    - path: pipelines/evaluation/data/eval_queries.json
      hash: md5
      md5: 8c088444f6a8b9a163b2cde6e0ee9ad5
      size: 6147
    params:
      params.yaml:
        evaluation:
          k: 5
          guardrail_threshold: 0.7
          samples: 50
    outs:
    - path: evaluation/metrics.json
      hash: md5
      md5: 402ebdc4af4cd58d81046e8218ea31d7
      size: 30
    - path: evaluation/results/
      hash: md5
      md5: c9301d62d46c41cab5324ce9698415ab.dir
      size: 9863
      nfiles: 1
